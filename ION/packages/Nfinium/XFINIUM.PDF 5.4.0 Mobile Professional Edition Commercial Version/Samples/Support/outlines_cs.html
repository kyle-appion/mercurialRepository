<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>.\Outlines.cs</title>
<style type="text/css">
body.hl	{ background-color:#ffffff; }
pre.hl	{ color:#000000; background-color:#ffffff; font-size:10pt; font-family:'Courier New',monospace;}
.hl.num { color:#000000; }
.hl.esc { color:#a31515; }
.hl.str { color:#a31515; }
.hl.pps { color:#0000ff; }
.hl.slc { color:#008000; }
.hl.com { color:#008000; }
.hl.ppc { color:#0000ff; }
.hl.opt { color:#000000; }
.hl.ipl { color:#a31515; }
.hl.lin { color:#2b91af; }
.hl.kwa { color:#0000ff; }
.hl.kwb { color:#0000ff; }
.hl.kwc { color:#2b91af; }
.hl.kwd { color:#000000; }
</style>
</head>
<body class="hl">
<pre class="hl"><span class="hl kwa">using</span> System<span class="hl opt">;</span>
<span class="hl kwa">using</span> System<span class="hl opt">.</span>IO<span class="hl opt">;</span>
<span class="hl kwa">using</span> Xfinium<span class="hl opt">.</span>Pdf<span class="hl opt">;</span>
<span class="hl kwa">using</span> Xfinium<span class="hl opt">.</span>Pdf<span class="hl opt">.</span>Graphics<span class="hl opt">;</span>
<span class="hl kwa">using</span> Xfinium<span class="hl opt">.</span>Pdf<span class="hl opt">.</span>Content<span class="hl opt">;</span>
<span class="hl kwa">using</span> Xfinium<span class="hl opt">.</span>Pdf<span class="hl opt">.</span>Actions<span class="hl opt">;</span>
<span class="hl kwa">using</span> Xfinium<span class="hl opt">.</span>Pdf<span class="hl opt">.</span>Destinations<span class="hl opt">;</span>

<span class="hl kwa">namespace</span> Xfinium<span class="hl opt">.</span>Pdf<span class="hl opt">.</span>Samples
<span class="hl opt">{</span>
    <span class="hl slc">/// &lt;summary&gt;</span>
    <span class="hl slc">/// Outlines sample.</span>
    <span class="hl slc">/// &lt;/summary&gt;</span>
    <span class="hl kwa">public class</span> Outlines
    <span class="hl opt">{</span>
        <span class="hl slc">/// &lt;summary&gt;</span>
        <span class="hl slc">/// Main method for running the sample.</span>
        <span class="hl slc">/// &lt;/summary&gt;</span>
        <span class="hl kwa">public static</span> SampleOutputInfo<span class="hl opt">[]</span> <span class="hl kwd">Run</span><span class="hl opt">()</span>
        <span class="hl opt">{</span>
            PdfFixedDocument document <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfFixedDocument</span><span class="hl opt">();</span>
            document<span class="hl opt">.</span>DisplayMode <span class="hl opt">=</span> PdfDisplayMode<span class="hl opt">.</span>UseOutlines<span class="hl opt">;</span>

            PdfStandardFont helvetica <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfStandardFont</span><span class="hl opt">(</span>PdfStandardFontFace<span class="hl opt">.</span>Helvetica<span class="hl opt">,</span> <span class="hl num">216</span><span class="hl opt">);</span>
            PdfBrush blackBrush <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfBrush</span><span class="hl opt">();</span>
            <span class="hl kwa">for</span> <span class="hl opt">(</span><span class="hl kwb">int</span> i <span class="hl opt">=</span> <span class="hl num">0</span><span class="hl opt">;</span> i <span class="hl opt">&lt;</span> <span class="hl num">10</span><span class="hl opt">;</span> i<span class="hl opt">++)</span>
            <span class="hl opt">{</span>
                PdfPage page <span class="hl opt">=</span> document<span class="hl opt">.</span>Pages<span class="hl opt">.</span><span class="hl kwd">Add</span><span class="hl opt">();</span>
                page<span class="hl opt">.</span>Graphics<span class="hl opt">.</span><span class="hl kwd">DrawString</span><span class="hl opt">((</span>i <span class="hl opt">+</span> <span class="hl num">1</span><span class="hl opt">).</span><span class="hl kwd">ToString</span><span class="hl opt">(),</span> helvetica<span class="hl opt">,</span> blackBrush<span class="hl opt">,</span> <span class="hl num">50</span><span class="hl opt">,</span> <span class="hl num">50</span><span class="hl opt">);</span>
            <span class="hl opt">}</span>

            PdfOutlineItem root <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfOutlineItem</span><span class="hl opt">();</span>
            root<span class="hl opt">.</span>Title <span class="hl opt">=</span> <span class="hl str">&quot;Contents&quot;</span><span class="hl opt">;</span>
            root<span class="hl opt">.</span>VisualStyle <span class="hl opt">=</span> PdfOutlineItemVisualStyle<span class="hl opt">.</span>Bold<span class="hl opt">;</span>
            root<span class="hl opt">.</span>Color <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfRgbColor</span><span class="hl opt">(</span><span class="hl num">255</span><span class="hl opt">,</span> <span class="hl num">0</span><span class="hl opt">,</span> <span class="hl num">0</span><span class="hl opt">);</span>
            document<span class="hl opt">.</span>Outline<span class="hl opt">.</span><span class="hl kwd">Add</span><span class="hl opt">(</span>root<span class="hl opt">);</span>

            <span class="hl kwa">for</span> <span class="hl opt">(</span><span class="hl kwb">int</span> i <span class="hl opt">=</span> <span class="hl num">0</span><span class="hl opt">;</span> i <span class="hl opt">&lt;</span> document<span class="hl opt">.</span>Pages<span class="hl opt">.</span>Count<span class="hl opt">;</span> i<span class="hl opt">++)</span>
            <span class="hl opt">{</span>
                <span class="hl slc">// Create a destination to target page.</span>
                PdfPageDirectDestination pageDestination <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfPageDirectDestination</span><span class="hl opt">();</span>
                pageDestination<span class="hl opt">.</span>Page <span class="hl opt">=</span> document<span class="hl opt">.</span>Pages<span class="hl opt">[</span>i<span class="hl opt">];</span>
                pageDestination<span class="hl opt">.</span>Top <span class="hl opt">=</span> <span class="hl num">0</span><span class="hl opt">;</span>
                pageDestination<span class="hl opt">.</span>Left <span class="hl opt">=</span> <span class="hl num">0</span><span class="hl opt">;</span>
                <span class="hl slc">// Inherit current zoom</span>
                pageDestination<span class="hl opt">.</span>Zoom <span class="hl opt">=</span> <span class="hl num">0</span><span class="hl opt">;</span>

                <span class="hl slc">// Create a go to action to be executed when the outline is clicked, </span>
                <span class="hl slc">// the go to action goes to specified destination.</span>
                PdfGoToAction gotoPage <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfGoToAction</span><span class="hl opt">();</span>
                gotoPage<span class="hl opt">.</span>Destination <span class="hl opt">=</span> pageDestination<span class="hl opt">;</span>

                <span class="hl slc">// Create the outline in the table of contents</span>
                PdfOutlineItem outline <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfOutlineItem</span><span class="hl opt">();</span>
                outline<span class="hl opt">.</span>Title <span class="hl opt">=</span> <span class="hl kwb">string</span><span class="hl opt">.</span><span class="hl kwd">Format</span><span class="hl opt">(</span><span class="hl str">&quot;Go to page</span> <span class="hl ipl">{0}</span><span class="hl str">&quot;</span><span class="hl opt">,</span> i <span class="hl opt">+</span> <span class="hl num">1</span><span class="hl opt">);</span>
                outline<span class="hl opt">.</span>VisualStyle <span class="hl opt">=</span> PdfOutlineItemVisualStyle<span class="hl opt">.</span>Italic<span class="hl opt">;</span>
                outline<span class="hl opt">.</span>Action <span class="hl opt">=</span> gotoPage<span class="hl opt">;</span>
                root<span class="hl opt">.</span>Items<span class="hl opt">.</span><span class="hl kwd">Add</span><span class="hl opt">(</span>outline<span class="hl opt">);</span>
            <span class="hl opt">}</span>
            root<span class="hl opt">.</span>Expanded <span class="hl opt">=</span> <span class="hl kwa">true</span><span class="hl opt">;</span>

            <span class="hl slc">// Create an outline that will launch a link in the browser.</span>
            PdfUriAction uriAction <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfUriAction</span><span class="hl opt">();</span>
            uriAction<span class="hl opt">.</span>URI <span class="hl opt">=</span> <span class="hl str">&quot;http://www.xfiniumsoft.com/&quot;</span><span class="hl opt">;</span>

            PdfOutlineItem webOutline <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfOutlineItem</span><span class="hl opt">();</span>
            webOutline<span class="hl opt">.</span>Title <span class="hl opt">=</span> <span class="hl str">&quot;http://www.xfiniumsoft.com/&quot;</span><span class="hl opt">;</span>
            webOutline<span class="hl opt">.</span>Color <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfRgbColor</span><span class="hl opt">(</span><span class="hl num">0</span><span class="hl opt">,</span> <span class="hl num">0</span><span class="hl opt">,</span> <span class="hl num">255</span><span class="hl opt">);</span>
            webOutline<span class="hl opt">.</span>Action <span class="hl opt">=</span> uriAction<span class="hl opt">;</span>
            document<span class="hl opt">.</span>Outline<span class="hl opt">.</span><span class="hl kwd">Add</span><span class="hl opt">(</span>webOutline<span class="hl opt">);</span>

            SampleOutputInfo<span class="hl opt">[]</span> output <span class="hl opt">=</span> <span class="hl kwa">new</span> SampleOutputInfo<span class="hl opt">[] {</span> <span class="hl kwa">new</span> <span class="hl kwd">SampleOutputInfo</span><span class="hl opt">(</span>document<span class="hl opt">,</span> <span class="hl str">&quot;xfinium.pdf.sample.outlines.pdf&quot;</span><span class="hl opt">) };</span>
            <span class="hl kwa">return</span> output<span class="hl opt">;</span>
        <span class="hl opt">}</span>
    <span class="hl opt">}</span>
<span class="hl opt">}</span>
</pre>
</body>
</html>
<!--HTML generated by highlight 3.12, http://www.andre-simon.de/-->
