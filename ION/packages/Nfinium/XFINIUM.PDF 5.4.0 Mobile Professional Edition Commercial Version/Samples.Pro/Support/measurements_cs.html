<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>.\Measurements.cs</title>
<style type="text/css">
body.hl	{ background-color:#ffffff; }
pre.hl	{ color:#000000; background-color:#ffffff; font-size:10pt; font-family:'Courier New',monospace;}
.hl.num { color:#000000; }
.hl.esc { color:#a31515; }
.hl.str { color:#a31515; }
.hl.pps { color:#0000ff; }
.hl.slc { color:#008000; }
.hl.com { color:#008000; }
.hl.ppc { color:#0000ff; }
.hl.opt { color:#000000; }
.hl.ipl { color:#a31515; }
.hl.lin { color:#2b91af; }
.hl.kwa { color:#0000ff; }
.hl.kwb { color:#0000ff; }
.hl.kwc { color:#2b91af; }
.hl.kwd { color:#000000; }
</style>
</head>
<body class="hl">
<pre class="hl"><span class="hl kwa">using</span> System<span class="hl opt">;</span>
<span class="hl kwa">using</span> Xfinium<span class="hl opt">.</span>Pdf<span class="hl opt">;</span>
<span class="hl kwa">using</span> Xfinium<span class="hl opt">.</span>Pdf<span class="hl opt">.</span>Graphics<span class="hl opt">;</span>
<span class="hl kwa">using</span> Xfinium<span class="hl opt">.</span>Pdf<span class="hl opt">.</span>Spatial<span class="hl opt">;</span>

<span class="hl kwa">namespace</span> Xfinium<span class="hl opt">.</span>Pdf<span class="hl opt">.</span>Samples
<span class="hl opt">{</span>
    <span class="hl slc">/// &lt;summary&gt;</span>
    <span class="hl slc">/// Measurements sample.</span>
    <span class="hl slc">/// &lt;/summary&gt;</span>
    <span class="hl kwa">public class</span> Measurements
    <span class="hl opt">{</span>
        <span class="hl slc">/// &lt;summary&gt;</span>
        <span class="hl slc">/// Main method for running the sample.</span>
        <span class="hl slc">/// &lt;/summary&gt;</span>
        <span class="hl kwa">public static</span> SampleOutputInfo<span class="hl opt">[]</span> <span class="hl kwd">Run</span><span class="hl opt">()</span>
        <span class="hl opt">{</span>
            <span class="hl slc">// Create the pdf document</span>
            PdfFixedDocument document <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfFixedDocument</span><span class="hl opt">();</span>
            <span class="hl slc">// Create a new page in the document</span>
            PdfPage page <span class="hl opt">=</span> document<span class="hl opt">.</span>Pages<span class="hl opt">.</span><span class="hl kwd">Add</span><span class="hl opt">();</span>

            PdfPen blackPen <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfPen</span><span class="hl opt">(</span>PdfRgbColor<span class="hl opt">.</span>Black<span class="hl opt">,</span> <span class="hl num">1</span><span class="hl opt">);</span>
            PdfPen redPen <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfPen</span><span class="hl opt">(</span>PdfRgbColor<span class="hl opt">.</span>Red<span class="hl opt">,</span> <span class="hl num">4</span><span class="hl opt">);</span>
            PdfPen greenPen <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfPen</span><span class="hl opt">(</span>PdfRgbColor<span class="hl opt">.</span>Green<span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">);</span>
            PdfBrush blackBrush <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfBrush</span><span class="hl opt">(</span>PdfRgbColor<span class="hl opt">.</span>Black<span class="hl opt">);</span>
            PdfStandardFont helvetica <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfStandardFont</span><span class="hl opt">(</span>PdfStandardFontFace<span class="hl opt">.</span>Helvetica<span class="hl opt">,</span> <span class="hl num">16</span><span class="hl opt">);</span>

            <span class="hl slc">// Draw viewport border.</span>
            page<span class="hl opt">.</span>Graphics<span class="hl opt">.</span><span class="hl kwd">DrawRectangle</span><span class="hl opt">(</span>blackPen<span class="hl opt">,</span> <span class="hl num">50</span><span class="hl opt">,</span> <span class="hl num">50</span><span class="hl opt">,</span> <span class="hl num">500</span><span class="hl opt">,</span> <span class="hl num">500</span><span class="hl opt">);</span>
            <span class="hl slc">// Draw the line to be measured.</span>
            page<span class="hl opt">.</span>Graphics<span class="hl opt">.</span><span class="hl kwd">DrawLine</span><span class="hl opt">(</span>greenPen<span class="hl opt">,</span> <span class="hl num">70</span><span class="hl opt">,</span> <span class="hl num">70</span><span class="hl opt">,</span> <span class="hl num">530</span><span class="hl opt">,</span> <span class="hl num">530</span><span class="hl opt">);</span>
            <span class="hl slc">// Draw point A (line start) in the viewport.</span>
            page<span class="hl opt">.</span>Graphics<span class="hl opt">.</span><span class="hl kwd">DrawLine</span><span class="hl opt">(</span>redPen<span class="hl opt">,</span> <span class="hl num">60</span><span class="hl opt">,</span> <span class="hl num">70</span><span class="hl opt">,</span> <span class="hl num">80</span><span class="hl opt">,</span> <span class="hl num">70</span><span class="hl opt">);</span>
            page<span class="hl opt">.</span>Graphics<span class="hl opt">.</span><span class="hl kwd">DrawLine</span><span class="hl opt">(</span>redPen<span class="hl opt">,</span> <span class="hl num">70</span><span class="hl opt">,</span> <span class="hl num">60</span><span class="hl opt">,</span> <span class="hl num">70</span><span class="hl opt">,</span> <span class="hl num">80</span><span class="hl opt">);</span>
            <span class="hl slc">// Draw point B (line end) in the viewport.</span>
            page<span class="hl opt">.</span>Graphics<span class="hl opt">.</span><span class="hl kwd">DrawLine</span><span class="hl opt">(</span>redPen<span class="hl opt">,</span> <span class="hl num">520</span><span class="hl opt">,</span> <span class="hl num">530</span><span class="hl opt">,</span> <span class="hl num">540</span><span class="hl opt">,</span> <span class="hl num">530</span><span class="hl opt">);</span>
            page<span class="hl opt">.</span>Graphics<span class="hl opt">.</span><span class="hl kwd">DrawLine</span><span class="hl opt">(</span>redPen<span class="hl opt">,</span> <span class="hl num">530</span><span class="hl opt">,</span> <span class="hl num">520</span><span class="hl opt">,</span> <span class="hl num">530</span><span class="hl opt">,</span> <span class="hl num">540</span><span class="hl opt">);</span>

            page<span class="hl opt">.</span>Graphics<span class="hl opt">.</span><span class="hl kwd">DrawString</span><span class="hl opt">(</span><span class="hl str">&quot;A&quot;</span><span class="hl opt">,</span> helvetica<span class="hl opt">,</span> blackBrush<span class="hl opt">,</span> <span class="hl num">85</span><span class="hl opt">,</span> <span class="hl num">65</span><span class="hl opt">);</span>
            page<span class="hl opt">.</span>Graphics<span class="hl opt">.</span><span class="hl kwd">DrawString</span><span class="hl opt">(</span><span class="hl str">&quot;B&quot;</span><span class="hl opt">,</span> helvetica<span class="hl opt">,</span> blackBrush<span class="hl opt">,</span> <span class="hl num">505</span><span class="hl opt">,</span> <span class="hl num">525</span><span class="hl opt">);</span>
            page<span class="hl opt">.</span>Graphics<span class="hl opt">.</span><span class="hl kwd">DrawString</span><span class="hl opt">(</span><span class="hl str">&quot;Viewport&quot;</span><span class="hl opt">,</span> helvetica<span class="hl opt">,</span> blackBrush<span class="hl opt">,</span> <span class="hl num">50</span><span class="hl opt">,</span> <span class="hl num">560</span><span class="hl opt">);</span>
            helvetica<span class="hl opt">.</span>Size <span class="hl opt">=</span> <span class="hl num">10</span><span class="hl opt">;</span>
            page<span class="hl opt">.</span>Graphics<span class="hl opt">.</span><span class="hl kwd">DrawString</span><span class="hl opt">(</span>
                <span class="hl str">&quot;Open the file with Adobe Acrobat and measure the distance from A to B using the Distance tool.&quot;</span><span class="hl opt">,</span> 
                helvetica<span class="hl opt">,</span> blackBrush<span class="hl opt">,</span> <span class="hl num">50</span><span class="hl opt">,</span> <span class="hl num">580</span><span class="hl opt">);</span>
            page<span class="hl opt">.</span>Graphics<span class="hl opt">.</span><span class="hl kwd">DrawString</span><span class="hl opt">(</span><span class="hl str">&quot;The measured distance should be 9 mi 186 ft 1 1/4 in.&quot;</span><span class="hl opt">,</span> 
                helvetica<span class="hl opt">,</span> blackBrush<span class="hl opt">,</span> <span class="hl num">50</span><span class="hl opt">,</span> <span class="hl num">590</span><span class="hl opt">);</span>

            <span class="hl slc">// Create a viewport that matches the rectangle above.</span>
            PdfViewport vp <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfViewport</span><span class="hl opt">();</span>
            vp<span class="hl opt">.</span>Name <span class="hl opt">=</span> <span class="hl str">&quot;Sample viewport&quot;</span><span class="hl opt">;</span>
            PdfPoint ll <span class="hl opt">=</span> page<span class="hl opt">.</span><span class="hl kwd">ConvertVisualPointToStandardPoint</span><span class="hl opt">(</span><span class="hl kwa">new</span> <span class="hl kwd">PdfPoint</span><span class="hl opt">(</span><span class="hl num">50</span><span class="hl opt">,</span> <span class="hl num">50</span><span class="hl opt">));</span>
            PdfPoint ur <span class="hl opt">=</span> page<span class="hl opt">.</span><span class="hl kwd">ConvertVisualPointToStandardPoint</span><span class="hl opt">(</span><span class="hl kwa">new</span> <span class="hl kwd">PdfPoint</span><span class="hl opt">(</span><span class="hl num">550</span><span class="hl opt">,</span> <span class="hl num">550</span><span class="hl opt">));</span>
            vp<span class="hl opt">.</span>Bounds <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfStandardRectangle</span><span class="hl opt">(</span>ll<span class="hl opt">,</span> ur<span class="hl opt">);</span>

            <span class="hl slc">// Add the viewport to the page</span>
            page<span class="hl opt">.</span>Viewports <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfViewportCollection</span><span class="hl opt">();</span>
            page<span class="hl opt">.</span>Viewports<span class="hl opt">.</span><span class="hl kwd">Add</span><span class="hl opt">(</span>vp<span class="hl opt">);</span>

            <span class="hl slc">// Create a rectilinear measure for the viewport (CAD drawing for example).</span>
            PdfRectilinearMeasure rlm <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfRectilinearMeasure</span><span class="hl opt">();</span>
            <span class="hl slc">// Attach the measure to the viewport.</span>
            vp<span class="hl opt">.</span>Measure <span class="hl opt">=</span> rlm<span class="hl opt">;</span>
            <span class="hl slc">// Set the measure scale: 1 inch (72 points) in PDF corresponds to 1 mile</span>
            rlm<span class="hl opt">.</span>ScaleRatio <span class="hl opt">=</span> <span class="hl str">&quot;1 in = 1 mi&quot;</span><span class="hl opt">;</span>

            <span class="hl slc">// Create a number format that controls the display of units for X axis.</span>
            PdfNumberFormat xNumberFormat <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfNumberFormat</span><span class="hl opt">();</span>
            xNumberFormat<span class="hl opt">.</span>MeasureUnit <span class="hl opt">=</span> <span class="hl str">&quot;mi&quot;</span><span class="hl opt">;</span>
            xNumberFormat<span class="hl opt">.</span>ConversionFactor <span class="hl opt">=</span> <span class="hl num">1</span><span class="hl opt">/</span><span class="hl num">72.0</span><span class="hl opt">;</span> <span class="hl slc">// Conversion from user space units to miles</span>
            xNumberFormat<span class="hl opt">.</span>FractionDisplay <span class="hl opt">=</span> PdfFractionDisplay<span class="hl opt">.</span>Decimal<span class="hl opt">;</span>
            xNumberFormat<span class="hl opt">.</span>Precision <span class="hl opt">=</span> <span class="hl num">100000</span><span class="hl opt">;</span>
            rlm<span class="hl opt">.</span>X <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfNumberFormatCollection</span><span class="hl opt">();</span>
            rlm<span class="hl opt">.</span>X<span class="hl opt">.</span><span class="hl kwd">Add</span><span class="hl opt">(</span>xNumberFormat<span class="hl opt">);</span>

            <span class="hl slc">// Create a chain of number formats that control the display of units for distance.</span>
            rlm<span class="hl opt">.</span>Distance <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfNumberFormatCollection</span><span class="hl opt">();</span>
            PdfNumberFormat miNumberFormat <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfNumberFormat</span><span class="hl opt">();</span>
            miNumberFormat<span class="hl opt">.</span>MeasureUnit <span class="hl opt">=</span> <span class="hl str">&quot;mi&quot;</span><span class="hl opt">;</span>
            miNumberFormat<span class="hl opt">.</span>ConversionFactor <span class="hl opt">=</span> <span class="hl num">1</span><span class="hl opt">;</span> <span class="hl slc">// Initial unit is miles; no conversion needed</span>
            rlm<span class="hl opt">.</span>Distance<span class="hl opt">.</span><span class="hl kwd">Add</span><span class="hl opt">(</span>miNumberFormat<span class="hl opt">);</span>
            PdfNumberFormat ftNumberFormat <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfNumberFormat</span><span class="hl opt">();</span>
            ftNumberFormat<span class="hl opt">.</span>MeasureUnit <span class="hl opt">=</span> <span class="hl str">&quot;ft&quot;</span><span class="hl opt">;</span>
            ftNumberFormat<span class="hl opt">.</span>ConversionFactor <span class="hl opt">=</span> <span class="hl num">5280</span><span class="hl opt">;</span> <span class="hl slc">// Conversion from miles to feet</span>
            rlm<span class="hl opt">.</span>Distance<span class="hl opt">.</span><span class="hl kwd">Add</span><span class="hl opt">(</span>ftNumberFormat<span class="hl opt">);</span>
            PdfNumberFormat inNumberFormat <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfNumberFormat</span><span class="hl opt">();</span>
            inNumberFormat<span class="hl opt">.</span>MeasureUnit <span class="hl opt">=</span> <span class="hl str">&quot;in&quot;</span><span class="hl opt">;</span>
            inNumberFormat<span class="hl opt">.</span>ConversionFactor <span class="hl opt">=</span> <span class="hl num">12</span><span class="hl opt">;</span> <span class="hl slc">// Conversion from feet to inches</span>
            inNumberFormat<span class="hl opt">.</span>FractionDisplay <span class="hl opt">=</span> PdfFractionDisplay<span class="hl opt">.</span>Fraction<span class="hl opt">;</span>
            inNumberFormat<span class="hl opt">.</span>Denominator <span class="hl opt">=</span> <span class="hl num">8</span><span class="hl opt">;</span> <span class="hl slc">// Fractions of inches rounded to nearest 1/8</span>
            rlm<span class="hl opt">.</span>Distance<span class="hl opt">.</span><span class="hl kwd">Add</span><span class="hl opt">(</span>inNumberFormat<span class="hl opt">);</span>

            <span class="hl slc">// Create a number format that controls the display of units area.</span>
            PdfNumberFormat areaNumberFormat <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfNumberFormat</span><span class="hl opt">();</span>
            areaNumberFormat<span class="hl opt">.</span>MeasureUnit <span class="hl opt">=</span> <span class="hl str">&quot;acres&quot;</span><span class="hl opt">;</span>
            areaNumberFormat<span class="hl opt">.</span>ConversionFactor <span class="hl opt">=</span> <span class="hl num">640</span><span class="hl opt">;</span> <span class="hl slc">// Conversion from square miles to acres</span>
            rlm<span class="hl opt">.</span>Area <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">PdfNumberFormatCollection</span><span class="hl opt">();</span>
            rlm<span class="hl opt">.</span>Area<span class="hl opt">.</span><span class="hl kwd">Add</span><span class="hl opt">(</span>xNumberFormat<span class="hl opt">);</span>

            SampleOutputInfo<span class="hl opt">[]</span> output <span class="hl opt">=</span> <span class="hl kwa">new</span> SampleOutputInfo<span class="hl opt">[] {</span> <span class="hl kwa">new</span> <span class="hl kwd">SampleOutputInfo</span><span class="hl opt">(</span>document<span class="hl opt">,</span> <span class="hl str">&quot;xfinium.pdf.sample.measurements.pdf&quot;</span><span class="hl opt">) };</span>
            <span class="hl kwa">return</span> output<span class="hl opt">;</span>
        <span class="hl opt">}</span>
    <span class="hl opt">}</span>
<span class="hl opt">}</span>
</pre>
</body>
</html>
<!--HTML generated by highlight 3.22, http://www.andre-simon.de/-->
